# 크리스마스 픽셀아트 애니메이션 프로젝트

## 프로젝트 개요
HTML, CSS, JavaScript만을 사용하여 크리스마스 테마의 픽셀아트 애니메이션을 구현하는 웹 프로젝트

## 기술 스택
- HTML5
- CSS3
- Vanilla JavaScript (프레임워크 없음)

## 주요 요구사항

### 1. 레이아웃
- 루트 도메인(`/`) 접근 시 메인 페이지 표시
- 화면 중앙에 적당한 크기의 창(컨테이너) 배치
- 반응형 디자인 고려 (다양한 화면 크기 대응)

### 2. 픽셀아트 애니메이션
- 크리스마스 테마의 픽셀아트 스타일 애니메이션
- 가능한 애니메이션 요소:
  - 눈 내리는 효과
  - 크리스마스 트리
  - 산타클로스
  - 선물 상자
  - 반짝이는 조명/별
  - 순록
  - 눈사람

### 3. 애니메이션 특징
- 픽셀아트 스타일 (레트로 게임 느낌)
- 부드러운 애니메이션 효과
- 크리스마스 분위기의 색상 팔레트 사용
  - 빨강, 녹색, 흰색, 금색 등

### 4. 구현 방식
- Canvas API 또는 CSS 애니메이션 활용
- JavaScript로 동적 애니메이션 제어
- 성능 최적화 고려
- **deltaTime 기반 애니메이션 시스템**
  - `requestAnimationFrame`의 `currentTime` 파라미터를 활용한 프레임 독립적 애니메이션
  - 모니터 주사율(60Hz, 120Hz, 144Hz 등)에 관계없이 일정한 속도 유지
  - 모든 속도는 "단위/초" 기준으로 정의 (픽셀/초, 라디안/초 등)
  - 가속도(중력 등)는 "단위/초²" 기준으로 정의

## 파일 구조
```
christmas-workspace/
├── index.html          # 메인 HTML 파일
├── styles.css          # 스타일시트
├── script.js           # JavaScript 로직
└── claude.md          # 프로젝트 문서 (현재 파일)
```

## 디자인 가이드라인
- 중앙 창 크기: 약 800x600px (또는 화면의 80% 내외)
- 픽셀 아트 크기: 각 픽셀은 명확하게 구분되도록
- 배경: 어두운 색상으로 픽셀아트가 돋보이도록
- 애니메이션 프레임: 부드러운 움직임을 위해 적절한 FPS 설정

## 구현 단계
1. 기본 HTML 구조 생성
2. CSS로 중앙 정렬 및 컨테이너 스타일링
3. 픽셀아트 캔버스 설정
4. 크리스마스 요소 그리기
5. 애니메이션 로직 구현
6. 최종 테스트 및 최적화

## ⚠️ 수정 금지 사항 (절대 변경하지 말 것)

### 1. 배경 디자인
- **검은색 계열 배경 유지 필수**
  - body 배경: `linear-gradient(135deg, #0a1628 0%, #1a2332 100%)`
  - canvas 배경: `#1a1a2e`
  - 이 배경색들은 픽셀아트를 돋보이게 하는 핵심 요소

### 2. 캔버스 윈도우 디자인
- **"Merry Christmas" 문구가 포함된 윈도우 헤더 유지**
  - 윈도우 헤더 스타일 (`window-header` 클래스)
  - 캔버스 테두리 및 그림자 효과
  - 윈도우 전체 디자인 (`window` 클래스)

### 3. 눈 내리는 애니메이션
- **현재 구현된 눈송이(Snowflake) 클래스 및 애니메이션 유지**
  - 50개의 눈송이
  - 부드러운 낙하 효과
  - 좌우 흔들림 효과 (`Math.sin` 기반)

### 4. 색상 팔레트
- **현재 사용 중인 모든 색상 유지 필수 (새로운 색상 추가는 가능)**
  - `COLORS` 객체의 모든 색상을 삭제하거나 변경 금지
  - 현재 색상 목록:
    ```javascript
    snow: '#FFFFFF'
    darkGreen: '#165B33'
    lightGreen: '#22A54D'
    brown: '#654321'
    red: '#C1292E'
    yellow: '#FFD700'
    lightBlue: '#87CEEB'
    darkBlue: '#1a1a2e'
    skin: '#FFDBAC'
    orange: '#FF6B35'
    star: '#FFF700'
    pink: '#FF69B4'
    ```
  - 이 색상들은 크리스마스 분위기를 완벽하게 표현함
  - 새로운 색상을 추가할 수는 있으나, 기존 색상을 제거하거나 수정해서는 안 됨

### 5. 크리스마스 트리 및 조명 (세트)
- **트리와 조명은 하나의 세트로 함께 유지**
  - 트리 구조: 3단 삼각형 형태 (하단/중간/상단)
  - 나무 기둥: 갈색 (COLORS.brown)
  - 잎 색상: darkGreen과 lightGreen 교차 패턴
  - 꼭대기 별: 노란색 (COLORS.star), 현재 크기 유지 (2배 크기)
  - **트리 조명 (Light 클래스)**:
    - 조명 개수: 21개 (하단 9개, 중간 6개, 상단 6개)
    - 조명 색상: 빨강(COLORS.red)과 노랑(COLORS.yellow) 2가지만
    - 깜빡임 속도: 느린 속도 유지 (speed / 2)
    - brightness 범위: 0.2 ~ 1.0
  - **위치는 변경 가능** (baseX, baseY 조정 가능)
  - 트리의 전체적인 형태, 색상 패턴, 별 디자인, 조명 설정은 절대 변경 금지

### 6. 밤하늘의 별
- **밤하늘의 별 유지**
  - 별 개수: 40개
  - 별 색상: 노란색 (COLORS.star)
  - 배치 영역: 하늘 상위 2/3 지점까지 (y: 0 ~ 77)
  - 크기: 랜덤 (70%는 1픽셀, 30%는 2픽셀)
  - 별의 개수, 색상, 배치 범위, 크기 분포는 절대 변경 금지

### 7. 달
- **달 유지**
  - 위치: 왼쪽 상단 (x: 20, y: 15)
  - 크기: 반지름 8픽셀 (원형)
  - 색상: 흰색 (COLORS.snow)
  - 크레이터: 밝은 회색 (#D3D3D3)
  - 달의 위치, 크기, 색상, 크레이터 디자인은 절대 변경 금지

### 8. 산타, 루돌프, 썰매 (세트)
- **산타, 루돌프, 썰매는 하나의 세트로 함께 유지**
  - **중요: script.js의 현재 구현이 절대적 기준**
    - rudolph.jpg, santa.png는 초기 참고용이었을 뿐
    - 현재 script.js에 타이핑된 픽셀 단위 디자인이 최종 완성본
    - 이미지 파일은 무시하고 오로지 현재 코드의 디자인만을 따를 것
  - **루돌프 (3마리)**:
    - `drawRudolph(x, y)` 함수의 현재 구현 유지
    - 색상: darkBrown (#654321), mediumBrown (#8B7355), lightBrown (#A0826D), beige (#C9B18A)
    - 빨간 코 (COLORS.red), 검은 눈 (#000000), 노란 방울 (COLORS.yellow)
    - 뿔, 얼굴, 목, 몸통, 다리의 모든 픽셀 배치
    - 3마리가 일렬로 배치 (x+8, x+20, x+32)
  - **산타**:
    - `drawSantaOnSleigh(x, y)` 함수의 현재 구현 유지
    - 빨간 모자와 옷 (COLORS.red), 흰 털 장식 (COLORS.snow)
    - 살구색 피부 (skin: #F5DEB3), 검은 눈 (#000000), 빨간 코 (COLORS.red)
    - 흰 수염 (COLORS.snow)
    - 모자, 얼굴, 수염, 몸통, 벨트의 모든 픽셀 배치
  - **썰매**:
    - `drawSleigh(x, y)` 함수의 현재 구현 유지
    - 빨간색 본체 (COLORS.red)
    - 은색 날 (#C0C0C0)
    - 금색 장식 라인 (COLORS.yellow)
    - 뒷부분 등받이, 본체, 앞부분 곡선, 날의 모든 픽셀 배치
  - **고삐/줄**:
    - `drawRudolphSleigh(x, y)` 내 고삐 구현 유지
    - 갈색 (#8B4513)
    - 루돌프 3마리와 썰매를 연결하는 모든 선분
  - **애니메이션**:
    - 왼쪽에서 오른쪽으로 이동 (30 픽셀/초)
    - 오른쪽 끝 도달 시 왼쪽에서 다시 시작 (x > 220 → x = -50)
  - **전체 세트의 y 위치는 변경 가능**
  - 각 함수 내부의 픽셀 단위 디자인, 색상, 좌표, 개수, 애니메이션 방식은 절대 변경 금지

### 9. 인터랙티브 선물 떨어뜨리기 기능 (추가됨)
- **클릭 시 선물이 떨어지는 인터랙티브 기능**
  - **Gift 클래스**:
    - 선물 색상: 빨강(COLORS.red), 진녹색(COLORS.darkGreen), 하늘색(COLORS.lightBlue), 분홍색(COLORS.pink) 중 랜덤
    - 선물 크기: 6x6 픽셀
    - 노란색 리본 장식 (가로/세로 교차, 상단 리본 장식)
    - 낙하 속도: 120 픽셀/초
    - 폭발 위치: 지면 경계(y=118)부터 적당한 깊이(y=130) 사이 랜덤
  - **클릭 이벤트**:
    - 화면 클릭 시 산타의 현재 위치에서 선물 생성
    - 선물 생성 위치: 산타 중심 (santaX - 4, y=30)
    - **쓰로틀링 적용**: 0.5초(500ms) 쿨다운
      - `lastClickTime`: 마지막 클릭 시간 저장
      - `clickCooldown`: 500ms
      - 연속 클릭 방지로 성능 최적화
      - 0.5초마다 최대 1개의 선물만 생성
  - **Particle 클래스** (폭발 이펙트):
    - 파티클 색상: 빨강, 노랑, 흰색, 별 색상, 주황색 중 랜덤
    - 파티클 크기: 1픽셀 또는 2픽셀 랜덤
    - 360도 모든 방향으로 랜덤 발사
    - 초기 속도: 60~240 픽셀/초
    - 중력 효과 적용 (gravity: 540 픽셀/초²)
    - 페이드아웃 효과 (life: 1.0 → 0, fadeSpeed: 1.2 단위/초)
    - 선물 생성 시: 6-8개 파티클
    - 땅 착지 시: 12-15개 파티클

### 10. 하늘 폭죽 이펙트 (추가됨)
- **5의 배수 선물 폭발 시 발동되는 폭죽 애니메이션**
  - **Firework 클래스** (로켓):
    - 발사 위치: 지면(y=118)에서 시작, x는 랜덤 (25~175)
    - 목표 높이: 랜덤 (y=20~60)
    - 상승 속도: 180 픽셀/초
    - 로켓 색상: 노란색 (COLORS.yellow)
    - 로켓 크기: 1x2 픽셀 (꼬리 포함)
    - 폭죽 색상 조합 (5가지):
      - 빨강 + 노랑
      - 하늘색 + 흰색
      - 별 색상 + 노랑
      - 분홍 + 흰색
      - 진녹색 + 연녹색
  - **FireworkParticle 클래스** (폭발 파티클):
    - 파티클 개수: 50-70개
    - 파티클 속도: 120~300 픽셀/초 (더 멀리 퍼짐)
    - 파티클 크기: 1픽셀(70%), 2픽셀(30%)
    - 360도 모든 방향으로 랜덤 발사
    - 중력 효과: 288 픽셀/초²
    - 공기 저항: 0.98 (deltaTime 보정 적용)
    - 페이드아웃: life 1.0 → 0, fadeSpeed 0.72 단위/초 (더 오래 보임)
    - **트레일(잔상) 효과**:
      - 각 불씨가 지나온 경로를 따라 점점 옅어지는 잔상 표시
      - 최대 트레일 길이: 15개 포인트
      - 투명도 계산: `(인덱스 / 길이) × life × 0.6`
      - 가장 오래된 포인트는 거의 투명, 최신 포인트는 60% 밝기
      - 현재 위치는 100% 밝기로 표시
      - 실제 폭죽처럼 혜성 꼬리 효과 생성
  - **발사 시스템**:
    - **트리거**: 선물이 5의 배수만큼 터졌을 때 (5개, 10개, 15개...)
    - **지속 시간**: 배너가 사라질 때까지 (산타 3번 왕복)
    - **발사 간격**: 1초 (1000ms)
    - **발사 확률**: 80%
    - **동시 발사**: 50% 확률로 1개 또는 2개 동시 발사
    - `bannerActive`가 true일 때만 발사

### 11. 산타 썰매 배너 (추가됨)
- **5의 배수 선물 폭발 시 나타나는 축하 배너**
  - **drawBanner 함수**:
    - 배너 위치: 산타 썰매 왼쪽 뒤 (x - 80)
    - 배너 크기: 55x10 픽셀
    - 배너 배경: 흰색 (COLORS.snow)
    - 배너 테두리: 빨간색 (COLORS.red)
    - 연결 줄: 갈색 (#8B4513), 배너 오른쪽에서 썰매까지
  - **텍스트**:
    - 문구: "태은이 국시 합격 기원"
    - 폰트: bold 20px Arial, sans-serif
    - 색상: 빨간색 (COLORS.red)
    - 정렬: 가운데 정렬
  - **활성화 조건**:
    - **트리거**: 선물이 5의 배수만큼 터졌을 때 (5개, 10개, 15개...)
    - **지속 시간**: 산타가 3번 왕복할 동안 (6번 사이클)
    - `giftExplodeCount % 5 === 0`일 때 활성화
  - **사이클 관리**:
    - `bannerActive`: 배너 활성화 여부
    - `bannerCycleCount`: 현재 사이클 카운트
    - `bannerCycleTarget`: 6 (3번 왕복)
    - 산타가 화면 끝에 도달할 때마다 카운트 증가
    - 배너가 완전히 화면 밖으로 나간 후 리셋 (x - 80 > 200)
  - **통합**:
    - `drawRudolphSleigh` 함수에서 배너 활성화 시에만 그림
    - 산타 이동 시 배너도 함께 따라다님
    - 배너 표시 중에는 배너가 완전히 사라질 때까지 기다림

### 12. deltaTime 기반 애니메이션 시스템 (구현 완료)
- **모든 애니메이션은 deltaTime 기반으로 동작**
  - **animate 함수**:
    - `currentTime` 파라미터 수신
    - `deltaTime = (currentTime - lastTime) / 1000` (초 단위로 변환)
    - 첫 프레임: deltaTime = 1/60 (60fps 기준)
    - 최대 deltaTime: 0.1초로 제한 (탭 전환 후 큰 점프 방지)
  - **모든 클래스의 update 메서드**:
    - `update(deltaTime)` 시그니처 사용
    - 위치 변경: `this.x += this.vx * deltaTime`
    - 속도 변경: `this.vy += this.gravity * deltaTime`
  - **속도 단위 변환 규칙** (60fps 기준):
    - 속도: `프레임 값 × 60` = 픽셀/초
      - 예: `0.5 픽셀/프레임 → 30 픽셀/초`
    - 가속도: `프레임 값 × 60 × 60` = 픽셀/초²
      - 예: `0.15 픽셀/프레임² → 540 픽셀/초²`
    - 페이드/밝기: `프레임 값 × 60` = 단위/초
      - 예: `0.02 단위/프레임 → 1.2 단위/초`
  - **공기 저항 처리**:
    - 프레임당 저항: `0.98` (매 프레임마다 98%)
    - deltaTime 보정: `Math.pow(0.98, deltaTime * 60)`
  - **적용된 클래스**:
    - `Snowflake`: 낙하 속도, 좌우 흔들림
    - `Light`: 깜빡임 속도
    - `Gift`: 낙하 속도, 회전 속도
    - `Particle`: 이동 속도, 중력, 페이드
    - `Firework`: 상승 속도
    - `FireworkParticle`: 이동 속도, 중력, 공기 저항, 페이드
    - 산타 썰매: 이동 속도 (30 픽셀/초)
  - **효과**:
    - 60Hz, 120Hz, 144Hz 모니터에서 동일한 속도로 재생
    - 프레임 드롭 시에도 일정한 애니메이션 속도 유지
    - 탭 전환 후 복귀해도 안정적 동작

### 수정 가능한 영역
- 픽셀아트 오브젝트의 위치, 크기, 개수
- 새로운 크리스마스 요소 추가
- 애니메이션 속도 및 움직임 패턴 (deltaTime 기반 유지)
- 새로운 색상 추가 (기존 색상 유지 전제하에)
- 성능 최적화
